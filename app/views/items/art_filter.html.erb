<!-- Image to replace radio button -->
<style>
	label > input.radio_hide {/* HIDE RADIO */
		visibility: hidden; /* Makes input not-clickable */
		position: absolute; /* Remove input from document flow */
	}
	label > input + img {/* IMAGE STYLES */
		cursor: pointer;
		border: 2px solid transparent;
	}
	label > input:checked + img {/* (RADIO CHECKED) IMAGE STYLES */
		border: 2px solid #f00;
		padding: 10px;
	}

	.loading {
		margin-top: 200px;
	}
</style>

<div class="container-fluid">
	<div class="row" style="margin-top: 50px">
		<div class="col-md-6" style="margin-top:50px; height: 800px" align="center">
			<div class="row">
				<%= image_tag get_image_url(@item, 'filter'), id:"filter_input", class: "filter_image"%>
			</div>

		

			<div class="row" style="margin-top: 40px; margin-bottom: 50px">
					<button type="button" id="use_this_style" disabled="disabled" onclick="submit();" class="btn btn-primary btn-lg">USE THIS STYLE</button>
			</div>
			
			<div class="row" align="left">
				<h4 class="no_bold" style="margin-left: 100px; font-color: grey"><%= link_to '<- Skip Art Filter', edit_item_path(@item) %></h4>
			</div>
		</div>
		<div class="col-md-6" style="height: 800px;">
			<div class=row>
				<h3 class="no_bold" style="margin-left: 10px">Choose Your Art Style</h3>
				<hr style="width: 95%" />
			</div>

			<%= form_for @item do |f| %>
			
			<!-- 1 row -->
			<div class="row" style="margin-top: 20px">
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;"%>
						<%= image_tag '/items/no_effects.jpg', size: "170x113", class: "clickable", id: "no_effects" %>
					</label>
				</div>
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_LnL71DkK" %>
						<%= image_tag '/items/abstract-thumb.jpg', size: "170x113", class: "style_option clickable", id: "LnL71DkK" %>
					</label>
				</div>
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_2kRl49ZW" %>
						<%= image_tag '/items/expressionist-thumb.jpg', size: "170x113", class: "style_option clickable", id: "2kRl49ZW" %>
					</label>
				</div>
			</div>
			
			<!-- 2 row -->
			<div class="row" style="margin-top: 20px">
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_LnL7j7kK" %>
						<%= image_tag '/items/nature-patterns-thumb.jpg', size: "170x113", class: "style_option clickable", id: "LnL7j7kK" %>
					</label>
				</div>
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_oEG3P0ER" %>
						<%= image_tag '/items/oil-painting-thumb.jpg', size: "170x113", class: "style_option clickable", id: "oEG3P0ER" %>
					</label>
				</div>
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_zZP0evZ0" %>
						<%= image_tag '/items/engraving-thumb.jpg', size: "170x113", class: "style_option clickable", id: "zZP0evZ0" %>
					</label>
				</div>
			</div>

			<!-- 3 row -->
			<div class="row" style="margin-top: 20px">
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_yE72lBZm" %>
						<%= image_tag '/items/composition_thumb_web.jpg', size: "170x113", class: "style_option clickable", id: "yE72lBZm" %>
					</label>
				</div>
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_gZDA63Ex" %>
						<%= image_tag '/items/pseudo_thumb_web.jpg', size: "170x113", class: "style_option clickable", id: "gZDA63Ex" %>
					</label>
				</div>
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_zZP0RvZ0" %>
						<%= image_tag '/items/candy_thumb_web.jpg', size: "170x113", class: "style_option clickable", id: "zZP0RvZ0" %>
					</label>
				</div>
			</div>
			
			<!-- 4 row -->
			<div class="row" style="margin-top: 20px">
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_MkeLoMEg" %>
						<%= image_tag '/items/impressionist-thumb.jpg', size: "170x113", class: "style_option clickable", id: "MkeLoMEg" %>
					</label>
				</div>
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_MZJNYmZY" %>
						<%= image_tag '/items/vibrant-painting-thumb.jpg', size: "170x113", class: "style_option clickable", id: "MZJNYmZY" %>
					</label>
				</div>
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_8k8aLmnM" %>
						<%= image_tag '/items/campaign-thumb.jpg', size: "170x113", class: "style_option clickable", id: "8k8aLmnM" %>
					</label>
				</div>
			</div>

			<!-- 5 row -->
			<div class="row" style="margin-top: 20px">
				<div class="col-md-4">
					<label>
						<%= f.radio_button :somatic_url, "#", style: "visibility: hidden;", id:"radio_vEzXdPnj" %>
						<%= image_tag '/items/mosaic-thumb.jpg', size: "170x113", class: "style_option clickable", id: "vEzXdPnj" %>
					</label>
				</div>
			</div>
			<%= hidden_field_tag :art_filterred, true %>
			<%= f.submit id: "art_style_options", style: "display: none" %>
			<% end %>
		</div>
	</div>

</div>

<script>
	$('.style_option').click(function() {
		$('#use_this_style').hide();
		
		var style_id = $(this).attr('id');
		var url = '<%= @somatic_realtime_api %>?id=' + style_id + 
				  '&api_key=' + '<%= @somatic_api_key %>' + 
				  '&--input=' + '<%= @item.image.filter.url %>';

		var newImage = new Image();
		var loadingSrc = '/loading.gif';
		$('#filter_input').attr('src', loadingSrc);
		$('#filter_input').addClass("loading");
		newImage.onload = function() {
    			$('#filter_input').attr('src', newImage.src);
    			$('#filter_input').removeClass("loading");
    			$('#use_this_style').show();
    			$('#use_this_style').removeAttr('disabled');
		};
		newImage.src = url;
		
		$('#radio_' + style_id).attr('value', url);	
		//$('#use_this_style').removeAttr('disabled');
	}); 
	
	$('#no_effects').click(function(){
		$('#filter_input').attr('src', '<%= get_image_url(@item, 'filter') %>');
		$('#use_this_style').attr('disabled', 'disabled');
	});
	function submit(){
		$('#art_style_options').click();
	}
</script>
