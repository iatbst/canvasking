<%= render "layouts/navbar" %>

<div class="container">
	<div class="row" style="margin-top: 100px">

		<% if @cart.items.count == 0 %>
		<div class="col-md-9">
			<h3>Woops, Your Cart is still empty. Let's build it !</h3>
			<%= button_to 'Get Building', new_item_path, method: :get, class:"btn btn-primary btn-lg" %>
		</div>
		<% else %>
		<%= render partial:'items', locals:{cart: @cart } %>
		<%= render partial:'summary', locals:{cart: @cart } %>
		<% end %>

	</div>
</div>

<script>
	// Using Jquery to update item quantities - Plus
	$("span.glyphicon-plus").click(function() {
		// get quantity
		var item_id = $(this).attr('name')
		var url = "/items/" + item_id
		$.ajax({
			url : url,
			type : 'PUT',
			data: "update_quantity=true&plus=true",
			success : function(result) {
				// Update item quantity on page
				$('#quantity_' + item_id).text(result.quantity);
				$('#cart_price').text(result.price);
				$('#cart_quantity').text(result.cart_quantity);
			}
		});
		
	});

	// Using Jquery to update item quantities - Minus
	$("span.glyphicon-minus").click(function() {
		// get quantity
		var item_id = $(this).attr('name')
		var url = "/items/" + item_id
		$.ajax({
			url : url,
			type : 'PUT',
			data: "update_quantity=true&minus=true",
			success : function(result) {
				// Update item quantity on page
				$('#quantity_' + item_id).text(result.quantity);
				$('#cart_price').text(result.price);
				$('#cart_quantity').text(result.cart_quantity);
			}
		});
		
	});

</script>
